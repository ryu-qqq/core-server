# 상품 및 옵션 매칭 로직

상품 업데이트 시 **옵션 그룹**과 **옵션 디테일**의 변경 여부를 판단하여, 기존 상품 및 옵션 데이터를 삭제, 추가, 또는 수정합니다.

---

## 1. 옵션 단위 매칭

옵션 매칭은 기존 데이터와 업데이트 요청 데이터를 비교하여, **옵션 그룹**과 **옵션 디테일**의 상태를 확인하고, 이에 따라 적절히 처리합니다.

### 1.1 매칭되는 옵션이 없는 경우
옵션 이름(Key)으로 매칭되는 기존 옵션이 없을 때의 처리:

- **기존 옵션 그룹에 새로운 옵션 디테일 추가**:
	- 예: 기존 옵션이 *사이즈(S, M)*였는데, *L*이 추가된 경우.
	- 처리: 기존 옵션 유지, 추가된 옵션만 등록.

- **기존 옵션 그룹에서 새로운 옵션 그룹으로 변경**:
	- 예: 기존 옵션이 *컬러(블랙, 화이트)*였는데, 업데이트 요청에서 *사이즈(S, M, L)*로 변경된 경우.
	- 처리: 기존 상품 및 옵션 삭제 후, 새로운 옵션 그룹에 따라 상품 및 옵션을 등록.

- **기존 상품이 모두 삭제 처리되는 이유**:
	- 옵션 그룹이 완전히 변경된 경우, 기존 옵션 그룹과 새로운 옵션 그룹 간 매칭이 불가능.
	- 예: 기존 상품 *블랙*과 *화이트*를 삭제하고, 새로운 상품 *S*와 *M*을 등록.

### 1.2 매칭되는 옵션이 있는 경우
옵션 이름(Key)으로 매칭되는 기존 옵션이 있는 경우:

- **기존 옵션 그룹이 유지됨**:
	- 예: 기존 옵션 그룹이 *컬러(블랙, 화이트)*였고, 업데이트 요청에서도 여전히 *컬러*.
	- 처리: 기존 옵션 그룹 유지.

- **옵션 디테일이 변경됨**:
	- 예: 기존 옵션이 *컬러(블랙)*에서 *컬러(블랙, 레드)*로 변경된 경우.
	- 처리: 기존 옵션 유지, 추가된 옵션 디테일(레드)만 등록.

---

## 2. 옵션 그룹 변경

옵션 그룹이 변경될 경우, 기존 데이터와 새로운 데이터 간의 매칭이 불가능합니다. 이 경우, 기존 상품과 옵션을 삭제하고 새로운 데이터로 등록합니다.

### 2.1 매칭되는 옵션이 없는 경우
- **예시**:
	- 기존: *사이즈(S, M, L), 컬러(블랙, 화이트)*
	- 변경 후: *사이즈(S)*

- **처리**:
	- 기존 상품 삭제.
	- 새로운 옵션 그룹(사이즈)에 따라 상품 및 옵션을 새로 등록.

### 2.2 매칭되는 옵션이 있는 경우
- **예시**:
	- 기존: *컬러(블랙, 화이트)*
	- 변경 후: *컬러(블랙), 사이즈(S)*

- **처리**:
	- 기존 옵션 그룹(컬러)의 매칭되는 옵션(블랙) 유지.
	- 새로운 옵션 그룹(사이즈)에 따라 추가된 상품 등록.

---

## 3. 복합적인 옵션 변경

옵션 그룹과 옵션 디테일이 동시에 변경될 경우, 기존 데이터의 매칭이 불가능할 가능성이 높습니다.

### 3.1 삭제 사례
- **예시**:
	- 기존: *사이즈(S, M, L), 컬러(블랙, 화이트)*
	- 변경 후: *사이즈(S)*

- **처리**:
	- 기존 상품 및 옵션 삭제.
	- 새로운 옵션 그룹(사이즈)에 따라 상품 및 옵션을 새로 등록.

### 3.2 추가 사례
- **예시**:
	- 기존: *사이즈(S, M, L)*
	- 변경 후: *사이즈(S, M, L), 컬러(블랙, 화이트)*

- **처리**:
	- 기존 상품 삭제.
	- 새로운 옵션 그룹(사이즈 + 컬러)에 따라 상품 및 옵션을 새로 등록.

---

## 4. 매칭되지 않는 옵션의 공통 처리

### 4.1 매칭되지 않는 옵션의 공통점
- 매칭되지 않는 옵션은 모두 **기존 데이터 삭제 및 신규 데이터 등록**으로 처리됩니다.

### 4.2 삭제 및 추가 처리의 예시
- **삭제 예시**:
	- 기존: *컬러(블랙, 화이트), 사이즈(S, M, L)*
	- 변경 후: *사이즈(S)*
	- 처리: 모든 기존 데이터를 삭제하고, *사이즈(S)*로 상품 등록.

- **추가 예시**:
	- 기존: *사이즈(S, M, L)*
	- 변경 후: *사이즈(S, M, L), 컬러(블랙, 화이트)*
	- 처리: 기존 상품 삭제, 새로운 옵션 그룹(사이즈 + 컬러)로 상품 등록.


 아래는 초본

	/**
	 * 옵션 이름으로 매핑되는 옵션을 찾는다.
	 *
	 * 1. 옵션 단 유지
	 *  - 매칭되는 옵션이 없다.
	 *      - 기존 옵션그룹에 새로운 옵션 디테일이 따졌다.
	 *      - 기존 옵션그룹에서 아예 새로운 옵션그룹으로 변경됬다 (컬러 -> 사이즈)
	 *      - 기존에 존재하는 상품들이 다 삭제 처리된다.
	 *
	 *  - 매칭되는 옵션이 있다.
	 *  	- 기존 옵션그룹이 유지된다.
	 *      - 옵션 디테일의 변경 가능성이 있다.
	 *
	 *
	 * 2. 옵션 단 변경
	 *
	 * - 매칭 되는 옵션이 있다. (고려 대상 X)
	 * 	   - 말이 안된다. (기존 블랙  -> 현재 블랙 S ) 이런식으로 글자가 추가되거나 삭제되 매칭이 될 수 가 없다.
	 * - 매칭 되는 옵션이 없다.
	 * 	   - 옵션 그룹의 변경 가능성이 있다. (컬러, 사이즈 -> 사이즈) or (컬러 -> 컬러,사이즈)
	 *
	 *
	 * ---> 매칭 되는 옵션이 없을때의 공통점
	 *    어떤 옵션이 추가되고 삭제됬는지
	 *    이 없는 (새롭게 인풋으로 들어간) 옵션의 그룹부터 기존의 옵션과 따져봐야함
	 *
	 *     (삭제되는 예시) 기존 사이즈, 컬러 (-> 생각해보면 매칭 되는 옵션이 하나도 없을테니 다 삭제처리가 되긴함)
	 *	   변경 후 사이즈
	 *
	 *	   기존의 프로덕트를 사용할수 없으니 다 삭제 후 새로 등록
	 *	   이유 블랙 S가 옐로 S 중 어떤게 S로 갈건지 합쳐서갈건지 모름 이렇게 옵션 한가지만 삭제되도 어디에 매칭시켜야 할 지 알 수 없음
	 *
	 *	   (추가되는 예시) 기존 사이즈
	 *	   변경 후 사이즈, 컬러
	 *
	 *	   기존의 프로덕트를 사용할수없으니 다 삭제 후 새로 등록 ( -> 생각해보면 매칭되는 옵션이 하나도 없을테니 다 삭제처리가 되긴함)
	 *	   이유 (S, M, L 이던 상품이 블랙 S, 옐로 S  이렇게 컬러가 두개만 추가 되도 어디에 매칭시켜야 할 지 알 수 없음)
	 *
	 *
	 */
